# 道路提取

- 1、构建深度学习提取道路轮廓，unet
- 2、通过形态学处理，优化道路
- 3、数据处理，首先将数据拆分为训练集和验证集，这里比例为8：2，生成5个文件记录5折交叉验证的训练集和验证集数据路径
- 4、优化方向：损失函数、数据增强、网络结构调整、误差较大数据类别分析
- 5、数据增强：图像旋转
- 6、可以选择使用外部数据集：
  - 6.1 * Massachusetts Roads Dataset（train_size 1108, 尺寸1500 * 1500）
  - 6.2 DeepGlobe Road Extraction Dataset
  - 6.3 * CHN6-CUG Road Dataset
  - 6.4 Aerial Image Segmentation Dataset
  - 6.5 Spacenet
  - 6.6 [遥感AI数据集](https://blog.csdn.net/nominior/article/details/105247990)
- 7、损失函数
  - 7.1 结合二元交叉熵（BCE）损失函数与 Dice 损失函数
- 8、评价指标
  - 用准确率（Rprecision）、召回率（Rrecall）、F1 分数（SF1）和交并比（RIoU）
- 9、消融实验
  消融实验评价不同的改进对结果的影响。


# 训练过程
- 1、用Unet,无数据增强，学习率0.1；batch_size为2；loss为BCE。训练集loss下降平稳，但在验证集上loss震动较为剧烈。验证集miou在12轮达到0.467，loss为8.83；14轮0.483，loss为8.68，最好效果为miou=0.522，后期miou在0.46-0.52之间回荡
unet如果最后一层没有sigmoid，则损失函数需要用BCEWithLogitsLoss，否则使用BCELoss。再验证过程中需要将输出结果转换为0或1像素值，可以用torch.where函数,阈值需要根据具体情况进行设置。对于二分类问题需要将label设置为0或1.
- 2、数据增强，cutout，考虑到道路连续性应该在边缘处进行cut；cutmix，将两幅图像cut一部分然后拼在一起，中间需要有纯黑条带隔开


# 改进方向
- 1、损失函数，BCE+Dice
- 2、模型结构，增加残差块，dropout，
- 3、数据增强，旋转、cut


# 参考文献
- 1、《基于改进U-Net的遥感图像道路提取》，由残差结构和注意力特征融合机制构成的注意力残差学习单元，提高对全局特征和局部特征的提取能力；在桥接网络加入注意力增强的空洞空间金字塔池化模块来增强不同尺度道路特征提取能力。空洞卷积即为原始图像行和列方向间隔几行或几列数据组成的数据范围进行卷积，正常的卷积是一块行或列均连续的范围。空洞卷积认为图像相邻像素之间存在数据的冗余，因此空洞卷积可以减少数据量且扩大感受野，还可以捕获多尺度上下文信息。空洞卷积的缺点是局部信息的丢失；远距离获取的信息没有相关性。空洞卷积实现上是在普通卷积Conv设置rate参数。损失函数采用BCE和Dice相结合，因为道路提取任务是类别不均衡任务，而BCE损失函数容易导致多数类过拟合，Dice可以解决此问题。
